<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Wednesday, December 06, 2017, 3:11 PM -->
<!-- MuClient version 4.84 -->

<!-- Plugin "Fantasy_Cards" generated by Plugin Wizard -->

<muclient>
    <plugin name="Fantasy_Cards" author="Castiel" id="718b55f05acd1868d31ab7f0" language="Lua" purpose="Shows missing cards" save_state="y" date_written="2017-12-06 15:10:28" requires="4.84" version="1.0">
        <description trim="n">
            <![CDATA[
.----------------------------------------------------------------------------.
| Loqui Fate Tracker Help                                                    |
|----------------------------------------------------------------------------|
|lft help -- Brings up the help section. (What you are reading now)          |
|lft search|find <card> -- Search if you have <card> or not.                 |
|lft summary <1|2|3|4> -- Summary of your card details for case #.           |
|lft report <1|2|3|4><channel> -- Report your card summary of case # to     |
|                                  a channel.                                |
|lft owned <1|2|3|4><channel> -- Report your owned cards in case # to a     |
|                                 channel.                                   |
'----------------------------------------------------------------------------'
]]>
        </description>
    </plugin>

    <aliases>
        <alias script="Help" match="^lft help$" enabled="y" regexp="y" sequence="100" ignore_case="y"></alias>
        <alias script="Summary" match="^lft summary (?<case>[0-4])$" enabled="y" regexp="y" sequence="100" ignore_case="y"></alias>
        <alias script="FindCard" match="^lft (search|find) (.*)$" enabled="y" regexp="y" sequence="100" ignore_case="y"></alias>
        <alias script="ReportCards" match="^lft report (?<case>[0-4]) (?<channel>.*)$" enabled="y" regexp="y" sequence="100" ignore_case="y"></alias>
        <alias script="ReportOwnedCards" match="^lft owned (?<case>[0-4]) (?<channel>.*)$" enabled="y" regexp="y" sequence="100" ignore_case="y"></alias>
    </aliases>

    <triggers>
        <trigger name="fate_start" regexp="y" match="^You have the following cards stored\:$" enabled="y" sequence="100" omit_from_output="n" script="StartCapture"></trigger>
        <trigger name="fate_ind_store" regexp="y" match="^You carefully place a (?<card>.*) (Fantasy|Expansion|Memorial and Immortal\'s|Original and Immortal\'s) Series Collector\'s Card within the (.*)?Case\.$" enabled="y" sequence="100" omit_from_output="n" script="Capture"></trigger>
        <trigger name="fate_ind_ret" regexp="y" match="^You carefully retrieve a (?<card>.*) (Fantasy|Expansion|Memorial and Immortal\'s|Original and Immortal\'s) Series Collector\'s Card from the (.*)?Case\.$" enabled="y" sequence="100" omit_from_output="n" script="RetrieveCard"></trigger>
        <trigger group="fate_capture" regexp="y" match="^(?<card>.*) (Fantasy|Expansion|Memorial and Immortal\'s|Original and Immortal\'s) Series Collector\'s Card$" enabled="n" sequence="100" omit_from_output="n" script="Capture"></trigger>
        <trigger group="fate_capture" regexp="y" match="^Total\: (?<total>.*)$" enabled="n" sequence="100" omit_from_output="n" script="StopCapture"></trigger>
    </triggers>

    <include name="constants.lua"/>

    <script>
        <![CDATA[
    require "serialize"

    local fateTable = {}

    function ResetTable()
        fateTable = {
            ["alessandrew"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["alhena"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["androg"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["ani"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["bejito"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["blurp"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["bonjour"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["cadaver"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["cartman"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["chuft"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["cordelia"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["craven"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["curi"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["dagonet"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["dave"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["demonspawn"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["dereliction"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["dexter"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["djvoltron"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["domain"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["evie"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["fatesdagger"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["galinthas"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["gren"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["hank"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["hiroki"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["jennie"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["leaf"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["linoge"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["lumina"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["madcatz"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["madrox"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["majic"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["marauder"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["marc"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["moolb"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["ninja"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["oladon"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["original"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["quadrapus"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["rafaele"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["rau"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["rezit"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["rocky"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["ruiner"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["saartje"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["speedster"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["stormlord"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["tirica"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["trez"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["trollemite"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["vanion"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["whisper"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["wojmil"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["yowza"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["zolstead"] = { count = 0, caseID = 1, caseName = "Fantasy Series" },
            ["abelinc"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["adam"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["arist"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["baktosh"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["blug"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["blunt"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["chich"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["corliss"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["dachande"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["danj"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["deadman"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["delgar"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["dexx"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["edit"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["erikson"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["fetard"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["fiendish"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["freddie"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["gastro"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["icecool"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["iceman"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["ixultar"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["koala"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["kya"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["level"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["liber"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["mars"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["mendaloth"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["milquetoast"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["mique"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["mirrim"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["moradin"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["morn"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["nasus"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["nocilis"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["paipals"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["pleiades"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["portia"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["pumpkin"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["razor"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["redryn"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["robbo"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["rojaz"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["slith"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["sonrokito"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["tinada"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["trachx"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["trurien"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["turie"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["tzitzimime"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["unforgiven"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["wars"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["whitdjinn"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["wire"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["zengo"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["zoot"] = { count = 0, caseID = 2, caseName = "Expansion Series" },
            ["aisis"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["andersen"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["arius"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["arthon"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["barchetta"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["barid"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["belmont"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["breeze"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["candace"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["cerridwen"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["confusion"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["dagaswolf"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["delight"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["dhamon"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["dirtworm"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["eclaboussure"]= { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["euphonix"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["fieryflame"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["filt"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["gangar"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["ghaan"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["glimmer"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["halo"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["ikyu"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["jaenelle"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["jernau"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["juli"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["kaitlyn"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["khelda"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["kinson"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["kt"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["lamoxes"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["llarian"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["martin"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["metallica"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["mordist"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["natallia"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["neeper"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["orsiphantes"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["pane"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["psychopath"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["roell"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["sarlock"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["senja"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["shadowfax"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["songbird"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["synthesizer"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["tallie"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["terrill"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["thirstan"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["tripitaka"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["tyanon"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["tymme"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["uncival"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["wolfe"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["xantcha"] = { count = 0, caseID = 3, caseName = "Memorial and Immortal's Series" },
            ["althalus"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["anaristos"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["baejita"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["banichi"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["broud"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["cassin"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["citron"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["claire"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["cynic"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["dadrake"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["darkmoore"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["dreamfyre"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["elisa"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["entreri"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["fufa"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["geneve"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["guinness"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["harvester"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["justme"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["kalince"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["kharpern"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["korridel"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["laren"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["lasher"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["lao"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["maerchyng"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["marcon"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["mashai"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["methdemon"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["moons"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["obyron"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["orcwarrior"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["paramore"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["penthesilea"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["pointless"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["pudge"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["rhuli"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["rumour"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["sagen"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["sirene"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["skarren"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["styliann"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["sunset"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["sylvain"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["tela"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["tenchi"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["teoyaomqui"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["testasterone"]= { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["timeghost"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["valkur"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["velvet"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["vesuvius"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["vilgan"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["vitae"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["xeno"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" },
            ["yandros"] = { count = 0, caseID = 4, caseName = "Original and Immortal's Series" } }
    end

    function Help()
        ColourNote("orange", "black", GetPluginInfo (GetPluginID (), 3))
    end

    function OnPluginInstall()
        if (GetVariable("fateTable") ~= nil) then	
            luastmt = "obj = " .. GetVariable("fateTable")
            assert (loadstring (luastmt or "")) ()		
            fateTable = obj
        else
            ResetTable()
        end
        Help()
    end

    function ReportCards(name, line, wildcards)
        local caseID = tonumber(wildcards.case)
        local caseName = ""
        local iCount = 0
        local sText = ""
        if caseID < 1 or caseID > 4 then
            ColourNote("orange", "", "Invalid case range. Case must be 1, 2, 3 or 4.")
            return
        end

        for key, value in pairsByKeys(fateTable) do
            if value.caseID == caseID then --Proper case
                if caseName == "" then
                    caseName = value.caseName
                end

                if tonumber(value.count) == 0 then --Don't have this card.
                    iCount = iCount + 1
                    if iCount == 1 then --First card, no need to add
                        sText = sText .. CapFirst(key)
                    else
                        sText = sText .. "@c,@W " .. CapFirst(key)
                    end
                end
            end
        end

        if tonumber(iCount) == 0 then
            sText = sText .. "No cards remaining."
        end

        Send(wildcards.channel .. " @C[@M" .. caseName .. "@C] @cCards left: @W" .. iCount .. "@c. Cards: @W" .. sText)
    end

    function ReportOwnedCards(name, line, wildcards)
        local caseID = tonumber(wildcards.case)
        local caseName = ""
        local iCount = 0
        local sText = ""
        if caseID < 1 or caseID > 4 then
            ColourNote("orange", "", "Invalid case range. Case must be 1, 2, 3 or 4.")
            return
        end

        for key, value in pairsByKeys(fateTable) do
            if value.caseID == caseID then --Proper case
                if caseName == "" then
                    caseName = value.caseName
                end

                if tonumber(value.count) == 1 then --Have this card.
                    iCount = iCount + 1
                    if iCount == 1 then --First card, no need to add
                        sText = sText .. CapFirst(key)
                    else
                        sText = sText .. "@c,@W " .. CapFirst(key)
                    end
                end
            end
        end

        if tonumber(iCount) == 0 then
            sText = sText .. "No cards owned."
        end

        Send(wildcards.channel .. " @C[@M" .. caseName .. "@C] @cCards owned: @W" .. tonumber(iCount) .. "@c. Cards: @W" .. sText)
    end

    function Summary(name, line, wildcards)
        local caseID = tonumber(wildcards.case)
        local caseName = ""
        local iCount = 0
        local iCount2 = 0
        local sText = ""

        if caseID < 1 or caseID > 4 then
            ColourNote("orange", "", "Invalid case range. Case must be 1, 2, 3 or 4.")
            return
        end

        for key, value in pairs(fateTable) do
            if value.caseID == caseID then
                if caseName == "" then
                    caseName = value.caseName
                end

                if value.count == 1 then
                    iCount = iCount + 1
                else
                    iCount2 = iCount2 + 1
                end
            end
        end
        ColourNote("orange", "", "Displaying your summary of Fate cards for case: ", "cyan", "", caseName)
        ColourNote("orange", "", "\n\rCards owned: ", "cyan", "", iCount, "orange", "", " Cards needed: ", "cyan", "", iCount2)

        iCount = 0
        local tCount = 0
        ColourNote("orange", "", "\n\rYou need the following cards:")
        for key, value in pairsByKeys(fateTable) do
            if value.caseID == caseID then --Proper case
                if tonumber(value.count) == 0 then --Don't have this card.
                    iCount = iCount + 1
                    tCount = tCount + 1
                    if iCount == 1 then --No tab in front
                        sText = sText .. string.format("%2i) %-15s", tCount, CapFirst(key))
                    elseif iCount >= 4 then --Done, send and start fresh
                        sText = sText .. "\t" .. string.format("%2i) %-15s", tCount, CapFirst(key))
                        ColourNote("cyan", "", sText)
                        iCount = 0
                        sText = ""
                    else --Add tab in front
                        sText = sText .. "\t" .. string.format("%2i) %-15s", tCount, CapFirst(key))
                    end
                end
            end
        end
        if iCount > 0 then --Leftover text, send it
            ColourNote("cyan", "", sText)
        end
    end

    function FindCard(name, line, wildcards)
        local sText = string.lower(wildcards[2])

        if fateTable[sText] == nil then
            ColourNote("orange", "", "The card \'" .. sText .. "\' does not exist in any sets.")
        else
            if fateTable[sText].count == 0 then
                ColourNote("orange", "", "You do ", "red", "", "NOT", "orange", "", " have the ", "cyan", "", CapFirst(sText), "orange", "", "[", "magenta", "", fateTable[sText].caseName, "orange", "", "] card.")
            else
                ColourNote("orange", "", "You ", "lime", "", "DO", "orange", "", " have the ", "cyan", "", CapFirst(sText), "orange", "", "[", "magenta", "", fateTable[sText].caseName, "orange", "", "] card.")
            end
        end
    end

    function StartCapture(name, line, wildcards)
        ResetTable()
        EnableTriggerGroup("fate_capture", true)
    end

    function Capture(name, line, wildcards)
        local cardName = string.lower(wildcards.card)
        if fateTable[cardName] ~= nil then
            fateTable[cardName].count = 1
        end
    end

    function RetrieveCard(name, line, wildcards)
        local cardName = string.lower(wildcards.card)
        if fateTable[cardName] ~= nil then
            fateTable[cardName].count = 0
        end
    end

    function StopCapture(name, line, wildcards)
        SetVariable("fateTable", serialize.save_simple(fateTable))
        EnableTriggerGroup("fate_capture", false)
    end

    function CapFirst(str)
        return (str:gsub("^%l", string.upper))
    end

    function pairsByKeys(t, f)
        local a = {}
        for n in pairs(t) do
            table.insert(a, n)
        end
        table.sort(a, f)
        local i = 0      -- iterator variable
        local iter = function ()   -- iterator function
            i = i + 1
            if a[i] == nil then
                return nil
            else
                return a[i], t[a[i]]
            end
        end
        return iter
    end
]]>
    </script>


</muclient>